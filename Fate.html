<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fate's Gambit</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
        }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #0f172a, #1e293b, #334155);
            color: #f1f5f9;
            min-height: 100vh;
            overflow: hidden;
        }

        .game-container {
            width: 100vw;
            height: 100vh;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .game-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .game-title {
            font-size: 2.5rem;
            color: #fbbf24;
            text-shadow: 2px 2px 8px rgba(251, 191, 36, 0.3);
            margin-bottom: 10px;
        }

        .turn-info {
            font-size: 1.2rem;
            color: #e2e8f0;
        }

        .current-player {
            color: #10b981;
            font-weight: bold;
        }

        /* Game Board */
        .game-board {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 1200px;
            height: 400px;
            position: relative;
        }

        /* Player Areas */
        .player-area {
            width: 280px;
            height: 350px;
            background: rgba(30, 41, 59, 0.8);
            border: 3px solid #475569;
            border-radius: 15px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
        }

        .player-area.active {
            border-color: #fbbf24;
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.3);
        }

        .player-area.fate {
            border-color: #dc2626;
            background: rgba(59, 7, 100, 0.8);
        }

        .player-area.fate.active {
            border-color: #ef4444;
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.4);
        }

        .player-header {
            text-align: center;
            margin-bottom: 15px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
        }

        .player-name {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .player-stats {
            display: flex;
            justify-content: space-between;
            font-size: 1rem;
        }

        .player-cards {
            flex: 1;
            display: flex;
            flex-wrap: nowrap;
            gap: 8px;
            justify-content: flex-start;
            align-items: flex-start;
            overflow-y: hidden;
            overflow-x: auto;
            padding: 10px;
            max-height: 250px;
            border: 2px solid rgba(71, 85, 105, 0.3);
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.2);
        }

        .player-cards::-webkit-scrollbar {
            height: 8px;
        }

        .player-cards::-webkit-scrollbar-track {
            background: rgba(71, 85, 105, 0.3);
            border-radius: 4px;
        }

        .player-cards::-webkit-scrollbar-thumb {
            background: #fbbf24;
            border-radius: 4px;
        }

        .player-cards::-webkit-scrollbar-thumb:hover {
            background: #f59e0b;
        }

        /* Center Deck Area */
        .deck-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .deck {
            width: 120px;
            height: 160px;
            background: linear-gradient(135deg, #1e293b, #334155);
            border: 4px solid #fbbf24;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .deck:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(251, 191, 36, 0.4);
        }

        .deck-symbol {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .deck-count {
            font-size: 1.1rem;
            color: #fbbf24;
            font-weight: bold;
        }

        .draw-button {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .draw-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4);
        }

        .draw-button:disabled {
            background: #6b7280;
            cursor: not-allowed;
            transform: none;
        }

        /* Cards */
        .card {
            width: 80px;
            height: 110px;
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            border: 2px solid #64748b;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            padding: 8px 4px;
            font-size: 0.8rem;
            text-align: center;
            color: #1e293b;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .card.major {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            border-color: #d97706;
            color: #1e293b;
            font-weight: bold;
        }

        .card.hidden {
            background: linear-gradient(135deg, #374151, #4b5563);
            border-color: #6b7280;
            color: #9ca3af;
        }

        .card-name {
            font-size: 0.7rem;
            font-weight: bold;
            line-height: 1.1;
            margin-bottom: 4px;
        }

        .card-power {
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 2px 6px;
            border-radius: 10px;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .card-ability {
            font-size: 0.6rem;
            color: #dc2626;
            font-style: italic;
            text-align: center;
            margin: 2px 0;
        }

        /* Game Log */
        .game-log {
            position: absolute;
            bottom: 20px;
            left: 20px;
            width: 350px;
            height: 200px;
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #475569;
            border-radius: 10px;
            padding: 15px;
            overflow-y: auto;
            font-size: 0.9rem;
        }

        .log-entry {
            margin: 3px 0;
            padding: 3px 0;
            border-left: 3px solid #fbbf24;
            padding-left: 8px;
            animation: fadeIn 0.5s ease;
        }

        .log-entry.steal {
            border-left-color: #dc2626;
            color: #fca5a5;
        }

        .log-entry.ability {
            border-left-color: #8b5cf6;
            color: #c4b5fd;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Game Over Modal */
        .game-over {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .game-over-content {
            background: linear-gradient(135deg, #1e293b, #334155);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            border: 4px solid #fbbf24;
            max-width: 500px;
        }

        .winner-text {
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: #fbbf24;
        }

        .final-scores {
            margin: 20px 0;
            font-size: 1.2rem;
        }

        .restart-button {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.2rem;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .restart-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);
        }

        /* Animations */
        @keyframes cardDraw {
            0% { 
                transform: scale(0.5) rotate(180deg); 
                opacity: 0;
            }
            50% { 
                transform: scale(1.2) rotate(90deg); 
                opacity: 0.8;
            }
            100% { 
                transform: scale(1) rotate(0deg); 
                opacity: 1;
            }
        }

        @keyframes cardSteal {
            0% { transform: scale(1); }
            25% { transform: scale(1.1) rotate(-5deg); }
            50% { transform: scale(1.2) rotate(5deg); }
            75% { transform: scale(1.1) rotate(-3deg); }
            100% { transform: scale(1) rotate(0deg); }
        }

        .card.drawing {
            animation: cardDraw 0.8s ease;
        }

        .card.stealing {
            animation: cardSteal 0.6s ease;
        }

        /* Card Zoom System */
        .card-zoom-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            backdrop-filter: blur(5px);
        }

        .card-zoom-container {
            position: relative;
            width: 300px;
            height: 400px;
            perspective: 1000px;
        }

        .card-zoom {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s ease;
            cursor: grab;
        }

        .card-zoom.flipped {
            transform: rotateY(180deg);
        }

        .card-zoom:active {
            cursor: grabbing;
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            padding: 30px 20px;
            font-size: 1.5rem;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .card-face.front {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            border: 4px solid #64748b;
            color: #1e293b;
        }

        .card-face.front.major {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            border-color: #d97706;
            color: #1e293b;
        }

        .card-face.back {
            background: linear-gradient(135deg, #1e293b, #334155);
            border: 4px solid #fbbf24;
            color: #f1f5f9;
            transform: rotateY(180deg);
        }

        .card-zoom .card-name {
            font-size: 1.8rem;
            font-weight: bold;
            line-height: 1.2;
            margin-bottom: 20px;
        }

        .card-zoom .card-power {
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 2rem;
            position: relative;
        }

        .card-zoom .card-ability {
            font-size: 1.2rem;
            color: #fbbf24;
            font-style: italic;
            text-align: center;
            line-height: 1.4;
            margin: 20px 0;
        }

        .power-bubble {
            position: absolute;
            top: -60px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 1.1rem;
            font-weight: bold;
            opacity: 0;
            animation: bubbleFloat 2s ease-in-out infinite;
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4);
        }

        .power-bubble.show {
            opacity: 1;
        }

        .power-bubble::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 8px solid #10b981;
        }

        @keyframes bubbleFloat {
            0%, 100% { transform: translateX(-50%) translateY(0px); }
            50% { transform: translateX(-50%) translateY(-10px); }
        }

        .zoom-controls {
            position: absolute;
            bottom: -80px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .zoom-button {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .zoom-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);
        }

        .zoom-button.flip {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
        }

        .zoom-button.close {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
        }

        .slide-hint {
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            color: #fbbf24;
            font-size: 0.9rem;
            opacity: 0.8;
            animation: slideHint 2s ease-in-out infinite;
        }

        @keyframes slideHint {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 0.4; }
        }

        .no-ability {
            color: #6b7280;
            font-style: italic;
            font-size: 1.1rem;
        }

        /* Touch/Drag indicators */
        .drag-indicator {
            position: absolute;
            top: 20px;
            right: 20px;
            color: rgba(255, 255, 255, 0.6);
            font-size: 1.5rem;
            animation: dragPulse 2s ease-in-out infinite;
        }

        @keyframes dragPulse {
            0%, 100% { opacity: 0.6; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.1); }
        }

        /* Duel Animation Styles */
        .duel-arena {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(220, 38, 38, 0.9), rgba(0, 0, 0, 0.95));
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 3000;
            backdrop-filter: blur(10px);
        }

        .duel-battlefield {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 90%;
            max-width: 1000px;
            position: relative;
        }

        .duel-side {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            width: 300px;
        }

        .duel-cards {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .duel-card {
            width: 100px;
            height: 130px;
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            border: 2px solid #64748b;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            padding: 8px 4px;
            font-size: 0.8rem;
            text-align: center;
            color: #1e293b;
            transition: all 0.5s ease;
            position: relative;
        }

        .duel-card.major {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            border-color: #d97706;
            color: #1e293b;
            font-weight: bold;
        }

        .duel-card.winner {
            animation: cardVictory 1s ease-in-out;
            z-index: 10;
        }

        .duel-card.loser {
            animation: cardShatter 1.5s ease-in-out forwards;
        }

        @keyframes cardVictory {
            0% { transform: scale(1); }
            25% { transform: scale(1.2) rotate(5deg); }
            50% { transform: scale(1.3) rotate(-5deg); box-shadow: 0 0 30px #fbbf24; }
            75% { transform: scale(1.2) rotate(3deg); }
            100% { transform: scale(1.1); box-shadow: 0 0 20px #10b981; }
        }

        @keyframes cardShatter {
            0% { 
                transform: scale(1); 
                opacity: 1; 
            }
            25% { 
                transform: scale(0.9) rotate(-10deg); 
                opacity: 0.8; 
            }
            50% { 
                transform: scale(0.7) rotate(15deg); 
                opacity: 0.6;
                filter: brightness(0.5);
            }
            75% { 
                transform: scale(0.4) rotate(-20deg); 
                opacity: 0.3;
                filter: brightness(0.2) blur(2px);
            }
            100% { 
                transform: scale(0.1) rotate(45deg); 
                opacity: 0;
                filter: brightness(0) blur(5px);
            }
        }

        .power-display {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: #1e293b;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.9rem;
            font-weight: bold;
            opacity: 0;
            animation: powerReveal 2s ease-in-out forwards;
            box-shadow: 0 2px 8px rgba(251, 191, 36, 0.4);
            z-index: 20;
        }

        @keyframes powerReveal {
            0% { 
                opacity: 0; 
                transform: translateX(-50%) translateY(10px) scale(0.8); 
            }
            50% { 
                opacity: 1; 
                transform: translateX(-50%) translateY(-5px) scale(1.1); 
            }
            100% { 
                opacity: 1; 
                transform: translateX(-50%) translateY(0px) scale(1); 
            }
        }

        .duel-vs {
            font-size: 4rem;
            color: #fbbf24;
            text-shadow: 0 0 20px rgba(251, 191, 36, 0.8);
            animation: vsGlow 2s ease-in-out infinite;
            position: relative;
        }

        @keyframes vsGlow {
            0%, 100% { 
                transform: scale(1); 
                text-shadow: 0 0 20px rgba(251, 191, 36, 0.8);
            }
            50% { 
                transform: scale(1.1); 
                text-shadow: 0 0 40px rgba(251, 191, 36, 1);
            }
        }

        .duel-power {
            font-size: 2rem;
            font-weight: bold;
            color: #f1f5f9;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            margin-top: 10px;
        }

        .duel-power.winner {
            color: #10b981;
            animation: powerPulse 0.5s ease-in-out;
        }

        .duel-power.loser {
            color: #dc2626;
            animation: powerFade 1s ease-in-out;
        }

        @keyframes powerPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        @keyframes powerFade {
            0% { opacity: 1; }
            100% { opacity: 0.3; }
        }

        .duel-result {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3rem;
            font-weight: bold;
            color: #fbbf24;
            text-shadow: 0 0 30px rgba(251, 191, 36, 1);
            opacity: 0;
            animation: resultReveal 2s ease-in-out 2s forwards;
        }

        @keyframes resultReveal {
            0% { 
                opacity: 0; 
                transform: translate(-50%, -50%) scale(0.5); 
            }
            50% { 
                opacity: 1; 
                transform: translate(-50%, -50%) scale(1.2); 
            }
            100% { 
                opacity: 1; 
                transform: translate(-50%, -50%) scale(1); 
            }
        }

        .duel-player-name {
            font-size: 1.5rem;
            font-weight: bold;
            color: #f1f5f9;
            margin-bottom: 10px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .game-board {
                flex-direction: column;
                height: auto;
                gap: 20px;
            }
            
            .player-area {
                width: 100%;
                max-width: 300px;
                height: 200px;
            }
            
            .game-log {
                position: relative;
                width: 100%;
                max-width: 350px;
                margin-top: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="game-header">
            <h1 class="game-title">⚡ FATE / KISMET ⚡</h1>
            <div class="turn-info">
                Turn <span id="currentTurn">1</span> of 53 | 
                <span class="current-player" id="currentPlayer">Your Turn</span>
            </div>
        </div>

        <div class="game-board">
            <!-- Human Player -->
            <div class="player-area active" id="humanArea">
                <div class="player-header">
                    <div class="player-name">You</div>
                    <div class="player-stats">
                        <span>Cards: <span id="humanCards">0</span></span>
                        <span>Power: <span id="humanPower">0</span></span>
                    </div>
                </div>
                <div class="player-cards" id="humanCardArea"></div>
            </div>

            <!-- Deck Area -->
            <div class="deck-area">
                <div class="deck" id="deck">
                    <div class="deck-symbol">🎴</div>
                    <div class="deck-count"><span id="deckCount">53</span> cards</div>
                </div>
                <button class="draw-button" id="drawButton" onclick="drawCard()">Draw Card</button>
                

                
                <!-- Challenge Button (appears after turn 8) -->
                <button class="draw-button" id="challengeButton" onclick="showChallengeOptions()" style="display: none; background: linear-gradient(135deg, #8b5cf6, #7c3aed); margin-top: 10px;">
                    ⚔️ Propose Duel
                </button>
            </div>

            <!-- AI Player -->
            <div class="player-area" id="aiArea">
                <div class="player-header">
                    <div class="player-name">Player 2</div>
                    <div class="player-stats">
                        <span>Cards: <span id="aiCards">0</span></span>
                        <span>Power: <span id="aiPower">0</span></span>
                    </div>
                </div>
                <div class="player-cards" id="aiCardArea"></div>
            </div>
        </div>

        <!-- FATE Player (appears when stealing) -->
        <div class="player-area fate" id="fateArea" style="position: absolute; top: 50%; right: 20px; transform: translateY(-50%); display: none;">
            <div class="player-header">
                <div class="player-name">FATE</div>
                <div class="player-stats">
                    <span>Cards: <span id="fateCards">0</span></span>
                    <span>Power: <span id="fatePower">0</span></span>
                </div>
            </div>
            <div class="player-cards" id="fateCardArea"></div>
        </div>

        <div class="game-log" id="gameLog">
            <div class="log-entry">Welcome to Fate's Gambit! Draw your first card.</div>
        </div>
    </div>

    <!-- Card Zoom Overlay -->
    <div class="card-zoom-overlay" id="cardZoomOverlay">
        <div class="card-zoom-container">
            <div class="slide-hint" id="slideHint">← Slide to see ability →</div>
            <div class="card-zoom" id="cardZoom">
                <div class="card-face front" id="cardFront">
                    <div class="drag-indicator">⟷</div>
                    <div class="card-name" id="zoomCardName"></div>
                    <div class="card-power" id="zoomCardPower">
                        <div class="power-bubble" id="powerBubble">Power: <span id="bubblePower"></span></div>
                    </div>
                </div>
                <div class="card-face back" id="cardBack">
                    <div class="card-name" id="zoomCardNameBack"></div>
                    <div class="card-ability" id="zoomCardAbility"></div>
                </div>
            </div>
            <div class="zoom-controls">
                <button class="zoom-button flip" onclick="flipCard()">🔄 Flip Card</button>
                <button class="zoom-button close" onclick="closeCardZoom()">✕ Close</button>
            </div>
        </div>
    </div>

    <!-- Duel Modal -->
    <div class="game-over" id="duelModal" style="display: none;">
        <div class="game-over-content">
            <div class="winner-text" id="duelTitle">⚔️ Choose Your Card</div>
            <div id="duelOpponent" style="margin-bottom: 20px; font-size: 1.2rem;"></div>
            <div id="playerDuelCards" style="display: flex; gap: 10px; justify-content: center; margin: 20px 0; flex-wrap: wrap;"></div>
            <div id="duelResult" style="margin: 20px 0; font-size: 1.1rem;"></div>
            <button class="restart-button" id="executeDuelBtn" onclick="executeDuel()" disabled>Fight!</button>
            <button class="restart-button" onclick="closeDuelModal()" style="background: linear-gradient(135deg, #6b7280, #4b5563);">Cancel</button>
        </div>
    </div>

    <!-- Challenge Modal -->
    <div class="game-over" id="challengeModal" style="display: none;">
        <div class="game-over-content">
            <div class="winner-text">⚔️ Propose Duel</div>
            <p style="margin-bottom: 20px;">Choose who to propose a duel to. They can accept or forfeit a card!</p>
            <button class="restart-button" onclick="proposeDuel('ai')" style="background: linear-gradient(135deg, #f59e0b, #d97706); margin: 10px;">
                ⚔️ Propose Duel to Player 2
            </button>
            <button class="restart-button" onclick="proposeDuel('fate')" style="background: linear-gradient(135deg, #dc2626, #b91c1c); margin: 10px;">
                💀 Propose Duel to FATE
            </button>
            <button class="restart-button" onclick="closeChallengeModal()" style="background: linear-gradient(135deg, #6b7280, #4b5563); margin: 10px;">
                Cancel
            </button>
        </div>
    </div>

    <!-- Duel Arena -->
    <div class="duel-arena" id="duelArena">
        <div class="duel-battlefield">
            <div class="duel-side" id="leftDuelSide">
                <div class="duel-player-name" id="leftPlayerName">You</div>
                <div class="duel-cards" id="leftDuelCards"></div>
                <div class="duel-power" id="leftDuelPower">0</div>
            </div>
            
            <div class="duel-vs">⚔️</div>
            
            <div class="duel-side" id="rightDuelSide">
                <div class="duel-player-name" id="rightPlayerName">Opponent</div>
                <div class="duel-cards" id="rightDuelCards"></div>
                <div class="duel-power" id="rightDuelPower">0</div>
            </div>
            
            <div class="duel-result" id="duelResultText"></div>
            
            <div class="duel-controls" id="duelControls" style="position: absolute; bottom: 50px; left: 50%; transform: translateX(-50%); display: flex; gap: 20px;">
                <button class="restart-button" id="continueDuelBtn" onclick="continueDuelAnimation()" style="background: linear-gradient(135deg, #10b981, #059669);">
                    ⚔️ Continue Duel
                </button>
            </div>
        </div>
    </div>

    <!-- Game Over Modal -->
    <div class="game-over" id="gameOver">
        <div class="game-over-content">
            <div class="winner-text" id="winnerText"></div>
            <div class="final-scores" id="finalScores"></div>
            <button class="restart-button" onclick="restartGame()">Play Again</button>
        </div>
    </div>

    <script>
        // Game State
        let currentTurn = 1;
        let currentPlayer = 'human'; // 'human', 'ai'
        let gameEnded = false;

        // Players
        let players = {
            human: { cards: [], power: 0 },
            ai: { cards: [], power: 0 },
            fate: { cards: [], power: 0 }
        };

        // Card Database (53 cards total - full deck)
        const cardDatabase = [
            // Major Arcana (22 cards)
            { name: "The Fool", power: 15, type: "major", ability: "Draw extra card", emoji: "○" },
            { name: "The Magician", power: 18, type: "major", ability: "Double power", emoji: "△" },
            { name: "The High Priestess", power: 16, type: "major", ability: "See opponent card", emoji: "◇" },
            { name: "The Empress", power: 17, type: "major", ability: "Heal all cards", emoji: "♦" },
            { name: "The Emperor", power: 20, type: "major", ability: "Cannot be stolen", emoji: "■" },
            { name: "The Hierophant", power: 14, type: "major", ability: "Protect from FATE", emoji: "⬟" },
            { name: "The Lovers", power: 19, type: "major", ability: "Share power", emoji: "♡" },
            { name: "The Chariot", power: 21, type: "major", ability: "Extra turn", emoji: "▲" },
            { name: "Strength", power: 22, type: "major", ability: "Destroy weak card", emoji: "◆" },
            { name: "The Hermit", power: 13, type: "major", ability: "Hide from duels", emoji: "◐" },
            { name: "Wheel of Fortune", power: 23, type: "major", ability: "Random power boost", emoji: "⬢" },
            { name: "Justice", power: 18, type: "major", ability: "Balance powers", emoji: "⬜" },
            { name: "The Hanged Man", power: 12, type: "major", ability: "Reverse duel result", emoji: "◑" },
            { name: "Death", power: 25, type: "major", ability: "Reset opponent", emoji: "●" },
            { name: "Temperance", power: 16, type: "major", ability: "Moderate all powers", emoji: "◈" },
            { name: "The Devil", power: 26, type: "major", ability: "Steal on draw", emoji: "▼" },
            { name: "The Tower", power: 24, type: "major", ability: "Destroy strongest", emoji: "▬" },
            { name: "The Star", power: 19, type: "major", ability: "Heal +5 power", emoji: "✦" },
            { name: "The Moon", power: 17, type: "major", ability: "Confuse opponents", emoji: "◒" },
            { name: "The Sun", power: 24, type: "major", ability: "Boost all cards", emoji: "◉" },
            { name: "Judgement", power: 27, type: "major", ability: "Revive lost card", emoji: "⬛" },
            { name: "The World", power: 28, type: "major", ability: "Ultimate victory", emoji: "⬣" },
            
            // Minor Arcana - Swords (8 cards)
            { name: "Ace of Swords", power: 12, type: "minor", ability: null, emoji: "⚔" },
            { name: "King of Swords", power: 14, type: "minor", ability: null, emoji: "⚡" },
            { name: "Queen of Swords", power: 13, type: "minor", ability: null, emoji: "⟐" },
            { name: "Knight of Swords", power: 11, type: "minor", ability: null, emoji: "⟢" },
            { name: "Ten of Swords", power: 10, type: "minor", ability: null, emoji: "⟡" },
            { name: "Nine of Swords", power: 9, type: "minor", ability: null, emoji: "⟠" },
            { name: "Eight of Swords", power: 8, type: "minor", ability: null, emoji: "⟟" },
            { name: "Seven of Swords", power: 7, type: "minor", ability: null, emoji: "⟞" },
            
            // Minor Arcana - Cups (8 cards)
            { name: "Ace of Cups", power: 12, type: "minor", ability: null, emoji: "◯" },
            { name: "King of Cups", power: 14, type: "minor", ability: null, emoji: "◎" },
            { name: "Queen of Cups", power: 13, type: "minor", ability: null, emoji: "◍" },
            { name: "Knight of Cups", power: 11, type: "minor", ability: null, emoji: "◌" },
            { name: "Ten of Cups", power: 10, type: "minor", ability: null, emoji: "◦" },
            { name: "Nine of Cups", power: 9, type: "minor", ability: null, emoji: "◯" },
            { name: "Eight of Cups", power: 8, type: "minor", ability: null, emoji: "◉" },
            { name: "Seven of Cups", power: 7, type: "minor", ability: null, emoji: "◈" },
            
            // Minor Arcana - Wands (8 cards)
            { name: "Ace of Wands", power: 12, type: "minor", ability: null, emoji: "▲" },
            { name: "King of Wands", power: 14, type: "minor", ability: null, emoji: "▴" },
            { name: "Queen of Wands", power: 13, type: "minor", ability: null, emoji: "△" },
            { name: "Knight of Wands", power: 11, type: "minor", ability: null, emoji: "▵" },
            { name: "Ten of Wands", power: 10, type: "minor", ability: null, emoji: "⧨" },
            { name: "Nine of Wands", power: 9, type: "minor", ability: null, emoji: "⧩" },
            { name: "Eight of Wands", power: 8, type: "minor", ability: null, emoji: "⧪" },
            { name: "Seven of Wands", power: 7, type: "minor", ability: null, emoji: "⧫" },
            
            // Minor Arcana - Pentacles (7 cards)
            { name: "Ace of Pentacles", power: 12, type: "minor", ability: null, emoji: "⬟" },
            { name: "King of Pentacles", power: 14, type: "minor", ability: null, emoji: "⬠" },
            { name: "Queen of Pentacles", power: 13, type: "minor", ability: null, emoji: "⬡" },
            { name: "Knight of Pentacles", power: 11, type: "minor", ability: null, emoji: "⬢" },
            { name: "Ten of Pentacles", power: 10, type: "minor", ability: null, emoji: "⬣" },
            { name: "Nine of Pentacles", power: 9, type: "minor", ability: null, emoji: "⬤" },
            { name: "Eight of Pentacles", power: 8, type: "minor", ability: null, emoji: "⬥" }
        ];

        // Game deck (shuffled)
        let deck = [...cardDatabase];
        shuffleDeck();

        function shuffleDeck() {
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
        }

        function drawCard() {
            if (gameEnded || deck.length === 0 || currentPlayer !== 'human') return;

            const card = deck.pop();
            players.human.cards.push(card);
            players.human.power += card.power;

            // Create card element and add to visible area
            const cardElement = createCardElement(card);
            cardElement.classList.add('drawing');
            const humanCardArea = document.getElementById('humanCardArea');
            humanCardArea.appendChild(cardElement);
            
            // Scroll to show the new card
            setTimeout(() => {
                humanCardArea.scrollLeft = humanCardArea.scrollWidth;
            }, 200);

            addLog(`You drew: ${card.name} (${card.power} power)`);
            
            if (card.ability) {
                addLog(`✨ Ability: ${card.ability}`, 'ability');
                applyCardAbility(card, 'human');
            }

            updateDisplay();
            nextTurn();
        }

        function applyCardAbility(card, player) {
            switch(card.name) {
                case "The Fool":
                    if (deck.length > 0 && player === 'human') {
                        setTimeout(() => {
                            const bonusCard = deck.pop();
                            players.human.cards.push(bonusCard);
                            players.human.power += bonusCard.power;
                            
                            const cardElement = createCardElement(bonusCard);
                            cardElement.classList.add('drawing');
                            const humanCardArea = document.getElementById('humanCardArea');
                            humanCardArea.appendChild(cardElement);
                            
                            // Scroll to show the new card
                            setTimeout(() => {
                                humanCardArea.scrollLeft = humanCardArea.scrollWidth;
                            }, 200);
                            
                            addLog(`The Fool grants bonus card: ${bonusCard.name}`, 'ability');
                            updateDisplay();
                        }, 1000);
                    }
                    break;
                    
                case "The Magician":
                    players[player].power += card.power; // Double the power
                    addLog(`The Magician doubles its power!`, 'ability');
                    break;
                    
                case "The Star":
                    players[player].power += 5;
                    addLog(`The Star heals for +5 power!`, 'ability');
                    break;
                    
                case "The Sun":
                    const boost = players[player].cards.length * 2;
                    players[player].power += boost;
                    addLog(`The Sun boosts all cards (+${boost} power)!`, 'ability');
                    break;
            }
        }

        function nextTurn() {
            // Switch between human and AI first
            if (currentPlayer === 'human') {
                currentPlayer = 'ai';
                updateTurnDisplay();
                setTimeout(aiTurn, 1000);
            } else {
                currentPlayer = 'human';
                currentTurn++;
                
                // Check for game end
                if (currentTurn > 53 || deck.length === 0) {
                    endGame();
                    return;
                }

                // Show duel proposal every 5th turn for human
                if (currentTurn % 5 === 0 && currentTurn > 0) {
                    document.getElementById('challengeButton').style.display = 'block';
                }

                // FATE steals every 5th turn
                if (currentTurn % 5 === 0) {
                    setTimeout(() => fateSteal(), 500);
                    return;
                }

                updateTurnDisplay();
            }
        }

        function aiTurn() {
            if (deck.length === 0) return;

            // Check if AI wants to propose duel (every 9th turn)
            if (currentTurn % 9 === 0 && currentTurn > 0 && Math.random() > 0.3) {
                setTimeout(() => aiProposeDuel(), 1000);
                return;
            }

            const card = deck.pop();
            players.ai.cards.push(card);
            players.ai.power += card.power;

            // Create hidden card for AI
            const cardElement = createHiddenCard();
            cardElement.classList.add('drawing');
            const aiCardArea = document.getElementById('aiCardArea');
            aiCardArea.appendChild(cardElement);
            
            // Scroll to show the new card
            setTimeout(() => {
                aiCardArea.scrollLeft = aiCardArea.scrollWidth;
            }, 200);

            addLog(`Player 2 drew a card (${card.power} power)`);

            if (card.ability) {
                addLog(`Player 2's card has a special ability!`, 'ability');
                applyCardAbility(card, 'ai');
            }

            updateDisplay();
            nextTurn();
        }

        function fateSteal() {
            document.getElementById('fateArea').style.display = 'block';
            document.getElementById('fateArea').classList.add('active');
            
            // After turn 45, FATE also draws cards
            if (currentTurn > 45 && deck.length > 0) {
                const drawnCard = deck.pop();
                players.fate.cards.push(drawnCard);
                players.fate.power += drawnCard.power;
                
                // Create card element for FATE
                const cardElement = createCardElement(drawnCard);
                cardElement.classList.add('drawing');
                const fateCardArea = document.getElementById('fateCardArea');
                fateCardArea.appendChild(cardElement);
                
                // Scroll to show the new card
                setTimeout(() => {
                    fateCardArea.scrollLeft = fateCardArea.scrollWidth;
                }, 200);
                
                addLog(`💀 FATE draws ${drawnCard.name} from the deck!`, 'steal');
                
                if (drawnCard.ability) {
                    addLog(`✨ FATE's card has a special ability: ${drawnCard.ability}`, 'ability');
                    applyCardAbility(drawnCard, 'fate');
                }
                
                updateDisplay();
                
                // Continue with normal FATE behavior after drawing
                setTimeout(() => {
                    // Check if FATE wants to propose duel instead (every 7th turn)
                    if (currentTurn % 7 === 0 && currentTurn > 0 && Math.random() > 0.4) {
                        setTimeout(() => fateProposeDuel(), 1000);
                        return;
                    }
                    
                    addLog(`💀 FATE also seeks to steal!`, 'steal');
                    performFateSteal();
                }, 2000);
                
                return;
            }
            
            // Check if FATE wants to propose duel instead (every 7th turn)
            if (currentTurn % 7 === 0 && currentTurn > 0 && Math.random() > 0.4) {
                setTimeout(() => fateProposeDuel(), 1000);
                return;
            }
            
            addLog(`💀 FATE emerges to steal!`, 'steal');
            performFateSteal();
        }

        function performFateSteal() {
            // Choose random target with cards
            const targets = [];
            if (players.human.cards.length > 0) targets.push('human');
            if (players.ai.cards.length > 0) targets.push('ai');

            if (targets.length === 0) {
                addLog(`FATE finds no cards to steal...`, 'steal');
                setTimeout(() => {
                    document.getElementById('fateArea').style.display = 'none';
                    currentPlayer = 'human';
                    updateTurnDisplay();
                }, 2000);
                return;
            }

            const target = targets[Math.floor(Math.random() * targets.length)];
            const targetCards = players[target].cards;
            
            // Check for protected cards (The Emperor)
            const unprotectedCards = targetCards.filter(card => card.name !== "The Emperor");
            const cardsToStealFrom = unprotectedCards.length > 0 ? unprotectedCards : targetCards;
            
            if (cardsToStealFrom.length > 0) {
                const randomIndex = targetCards.indexOf(cardsToStealFrom[Math.floor(Math.random() * cardsToStealFrom.length)]);
                const stolenCard = targetCards.splice(randomIndex, 1)[0];
                
                players[target].power -= stolenCard.power;
                players.fate.cards.push(stolenCard);
                players.fate.power += stolenCard.power;

                const targetName = target === 'human' ? 'You' : 'Player 2';
                addLog(`💀 FATE steals ${stolenCard.name} from ${targetName}!`, 'steal');

                // Remove card from display
                const targetArea = document.getElementById(target + 'CardArea');
                if (targetArea.children[randomIndex]) {
                    const cardElement = targetArea.children[randomIndex];
                    cardElement.classList.add('stealing');
                    setTimeout(() => {
                        targetArea.removeChild(cardElement);
                        
                        // Add to FATE's area
                        const fateCard = createCardElement(stolenCard);
                        const fateCardArea = document.getElementById('fateCardArea');
                        fateCardArea.appendChild(fateCard);
                        
                        // Scroll to show the new card
                        setTimeout(() => {
                            fateCardArea.scrollLeft = fateCardArea.scrollWidth;
                        }, 200);
                    }, 600);
                }
            }

            updateDisplay();

            setTimeout(() => {
                document.getElementById('fateArea').classList.remove('active');
                setTimeout(() => {
                    document.getElementById('fateArea').style.display = 'none';
                    currentPlayer = 'human';
                    updateTurnDisplay();
                }, 500);
            }, 3000);
        }

        function createCardElement(card) {
            const cardElement = document.createElement('div');
            cardElement.className = `card ${card.type}`;
            
            const abilityText = card.ability ? `<div class="card-ability">${card.ability}</div>` : '';
            
            cardElement.innerHTML = `
                <div class="card-emoji" style="font-size: 2rem; margin-bottom: 4px;">${card.emoji}</div>
                <div class="card-name">${card.name}</div>
                ${abilityText}
                <div class="card-power">${card.power}</div>
            `;
            
            // Add click event for zoom
            cardElement.addEventListener('click', (e) => {
                e.stopPropagation();
                openCardZoom(card);
            });
            
            return cardElement;
        }

        function createHiddenCard() {
            const cardElement = document.createElement('div');
            cardElement.className = 'card hidden';
            cardElement.innerHTML = `
                <div class="card-name">Hidden</div>
                <div class="card-power">?</div>
            `;
            return cardElement;
        }

        function updateDisplay() {
            document.getElementById('humanCards').textContent = players.human.cards.length;
            document.getElementById('humanPower').textContent = players.human.power;
            document.getElementById('aiCards').textContent = players.ai.cards.length;
            document.getElementById('aiPower').textContent = '?';
            document.getElementById('fateCards').textContent = players.fate.cards.length;
            document.getElementById('fatePower').textContent = '?';
            document.getElementById('deckCount').textContent = deck.length;
        }

        function updateTurnDisplay() {
            document.getElementById('currentTurn').textContent = currentTurn;
            
            const playerElement = document.getElementById('currentPlayer');
            const humanArea = document.getElementById('humanArea');
            const aiArea = document.getElementById('aiArea');
            const drawButton = document.getElementById('drawButton');
            const challengeButton = document.getElementById('challengeButton');
            
            // Reset active states
            humanArea.classList.remove('active');
            aiArea.classList.remove('active');
            
            if (currentPlayer === 'human') {
                playerElement.textContent = 'Your Turn';
                humanArea.classList.add('active');
                drawButton.disabled = false;
                
                // Show challenge button after turn 8
                if (currentTurn > 8) {
                    challengeButton.style.display = 'block';
                }
            } else {
                playerElement.textContent = "Player 2's Turn";
                aiArea.classList.add('active');
                drawButton.disabled = true;
                challengeButton.style.display = 'none';
            }
        }

        // Duel System
        let selectedDuelCards = [];
        let duelOpponent = null;

        function showDuelOptions() {
            if (currentPlayer !== 'human') return;
            
            document.getElementById('duelButtons').style.display = 'block';
            document.getElementById('drawButton').disabled = true;
            addLog(`⚔️ Turn ${currentTurn}: Duel time! Choose your action.`);
        }

        function initiateDuel(opponent) {
            if (players.human.cards.length === 0) {
                addLog(`You have no cards to duel with!`);
                return;
            }

            duelOpponent = opponent;
            selectedDuelCards = [];
            
            const modal = document.getElementById('duelModal');
            const title = document.getElementById('duelTitle');
            const opponentText = document.getElementById('duelOpponent');
            const cardsContainer = document.getElementById('playerDuelCards');
            const executeBtn = document.getElementById('executeDuelBtn');
            
            title.textContent = '⚔️ Choose Up to 3 Cards for Duel';
            opponentText.textContent = `Dueling against: ${opponent === 'ai' ? 'Player 2' : 'FATE'} | Selected: 0/3`;
            
            // Clear previous cards
            cardsContainer.innerHTML = '';
            executeBtn.disabled = true;
            
            // Show player's cards for selection
            players.human.cards.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = `card ${card.type}`;
                cardElement.style.cursor = 'pointer';
                cardElement.style.margin = '5px';
                cardElement.onclick = () => toggleDuelCard(index, cardElement);
                
                const abilityText = card.ability ? `<div class="card-ability">${card.ability}</div>` : '';
                cardElement.innerHTML = `
                    <div class="card-emoji" style="font-size: 2rem; margin-bottom: 4px;">${card.emoji}</div>
                    <div class="card-name">${card.name}</div>
                    ${abilityText}
                    <div class="card-power">${card.power}</div>
                `;
                
                cardsContainer.appendChild(cardElement);
            });
            
            modal.style.display = 'flex';
            
            // Close challenge modal if open
            document.getElementById('challengeModal').style.display = 'none';
        }

        function toggleDuelCard(index, element) {
            const cardIndex = selectedDuelCards.indexOf(index);
            
            if (cardIndex > -1) {
                // Deselect card
                selectedDuelCards.splice(cardIndex, 1);
                element.style.border = element.classList.contains('major') ? '2px solid #d97706' : '2px solid #64748b';
                element.style.transform = 'scale(1)';
            } else if (selectedDuelCards.length < 3) {
                // Select card (max 3)
                selectedDuelCards.push(index);
                element.style.border = '3px solid #fbbf24';
                element.style.transform = 'scale(1.05)';
            } else {
                // Max cards reached
                addLog(`You can only select up to 3 cards for a duel!`);
                return;
            }
            
            // Update UI
            const opponentText = document.getElementById('duelOpponent');
            const opponentName = duelOpponent === 'ai' ? 'Player 2' : 'FATE';
            opponentText.textContent = `Dueling against: ${opponentName} | Selected: ${selectedDuelCards.length}/3`;
            
            // Enable/disable execute button
            document.getElementById('executeDuelBtn').disabled = selectedDuelCards.length === 0;
        }

        function executeDuel() {
            if (selectedDuelCards.length === 0 || !duelOpponent) return;
            
            const playerCards = selectedDuelCards.map(index => players.human.cards[index]);
            const opponentCards = players[duelOpponent].cards;
            
            if (opponentCards.length === 0) {
                document.getElementById('duelResult').innerHTML = `
                    <div style="color: #fbbf24;">Opponent has no cards to duel with!</div>
                `;
                setTimeout(() => {
                    closeDuelModal();
                    continueTurn();
                }, 2000);
                return;
            }
            
            // Opponent chooses up to 3 cards
            const opponentDuelCards = [];
            const maxOpponentCards = Math.min(3, opponentCards.length);
            
            if (duelOpponent === 'ai') {
                // AI picks strongest cards
                const sortedCards = [...opponentCards].sort((a, b) => b.power - a.power);
                for (let i = 0; i < maxOpponentCards; i++) {
                    opponentDuelCards.push(sortedCards[i]);
                }
            } else {
                // FATE picks random cards
                const shuffledCards = [...opponentCards].sort(() => Math.random() - 0.5);
                for (let i = 0; i < maxOpponentCards; i++) {
                    opponentDuelCards.push(shuffledCards[i]);
                }
            }
            
            // Close duel modal and show animation
            closeDuelModal();
            showDuelAnimation(playerCards, opponentDuelCards, duelOpponent);
        }

        function applyDuelBonus(card, basePower) {
            let bonus = 0;
            switch(card.name) {
                case "The Magician":
                    bonus = basePower; // Double power
                    break;
                case "Strength":
                    bonus = 10;
                    break;
                case "The Sun":
                    bonus = 15;
                    break;
                case "The World":
                    bonus = 20;
                    break;
                default:
                    bonus = 5; // Default major arcana bonus
            }
            return basePower + bonus;
        }

        function showDuelAnimation(playerCards, opponentCards, opponent) {
            // Set duel context
            currentDuelContext = {
                opponent: opponent,
                playerCards: playerCards,
                opponentCards: opponentCards
            };
            
            const arena = document.getElementById('duelArena');
            const leftCards = document.getElementById('leftDuelCards');
            const rightCards = document.getElementById('rightDuelCards');
            const leftPower = document.getElementById('leftDuelPower');
            const rightPower = document.getElementById('rightDuelPower');
            const rightPlayerName = document.getElementById('rightPlayerName');
            const resultText = document.getElementById('duelResultText');
            
            // Set opponent name
            const opponentName = opponent === 'ai' ? 'Player 2' : 'FATE';
            rightPlayerName.textContent = opponentName;
            
            // Clear previous cards and result
            leftCards.innerHTML = '';
            rightCards.innerHTML = '';
            resultText.textContent = '';
            resultText.style.opacity = '0';
            
            // Calculate powers
            let playerTotalPower = 0;
            let opponentTotalPower = 0;
            
            // Create player cards
            playerCards.forEach(card => {
                let cardPower = card.power;
                if (card.type === 'major') {
                    cardPower = applyDuelBonus(card, cardPower);
                }
                playerTotalPower += cardPower;
                
                const cardElement = createDuelCard(card, cardPower);
                leftCards.appendChild(cardElement);
            });
            
            // Create opponent cards
            opponentCards.forEach(card => {
                let cardPower = card.power;
                if (card.type === 'major') {
                    cardPower = applyDuelBonus(card, cardPower);
                }
                opponentTotalPower += cardPower;
                
                const cardElement = createDuelCard(card, cardPower);
                rightCards.appendChild(cardElement);
            });
            
            // Set initial powers
            leftPower.textContent = playerTotalPower;
            rightPower.textContent = opponentTotalPower;
            
            // Show arena
            arena.style.display = 'flex';
            
            // Show continue button initially
            document.getElementById('duelControls').style.display = 'flex';
            document.getElementById('continueDuelBtn').style.display = 'block';
        }

        function continueDuelAnimation() {
            // Hide continue button
            document.getElementById('duelControls').style.display = 'none';
            
            const arena = document.getElementById('duelArena');
            const leftCards = document.getElementById('leftDuelCards');
            const rightCards = document.getElementById('rightDuelCards');
            const leftPower = document.getElementById('leftDuelPower');
            const rightPower = document.getElementById('rightDuelPower');
            const resultText = document.getElementById('duelResultText');
            
            // Get power values
            const playerTotalPower = parseInt(leftPower.textContent);
            const opponentTotalPower = parseInt(rightPower.textContent);
            
            // Start battle animation
            setTimeout(() => {
                const playerWins = playerTotalPower > opponentTotalPower;
                
                // Animate cards
                const winnerCards = playerWins ? leftCards.children : rightCards.children;
                const loserCards = playerWins ? rightCards.children : leftCards.children;
                const winnerPower = playerWins ? leftPower : rightPower;
                const loserPower = playerWins ? rightPower : leftPower;
                
                // Add winner/loser classes
                Array.from(winnerCards).forEach(card => card.classList.add('winner'));
                Array.from(loserCards).forEach(card => card.classList.add('loser'));
                winnerPower.classList.add('winner');
                loserPower.classList.add('loser');
                
                // Show result text
                resultText.textContent = playerWins ? '🏆 VICTORY!' : '💀 DEFEAT!';
                resultText.style.color = playerWins ? '#10b981' : '#dc2626';
                
                // Execute card transfers after animation
                setTimeout(() => {
                    // Get current duel context
                    const currentOpponent = getCurrentDuelOpponent();
                    const currentPlayerCards = getCurrentPlayerDuelCards();
                    const currentOpponentCards = getCurrentOpponentDuelCards();
                    
                    if (playerWins) {
                        // Player wins - transfer logic
                        transferCardsToPlayer(currentOpponentCards, currentOpponent);
                        addLog(`⚔️ EPIC DUEL WON! You win ${currentOpponentCards.length} cards!`);
                    } else {
                        // Opponent wins - transfer logic  
                        transferCardsFromPlayer(currentPlayerCards, currentOpponent);
                        addLog(`⚔️ EPIC DUEL LOST! Opponent wins your ${currentPlayerCards.length} cards!`, 'steal');
                    }
                    
                    // Update displays
                    updateCardDisplay();
                    updateDisplay();
                    
                    // Hide arena and continue
                    setTimeout(() => {
                        arena.style.display = 'none';
                        finishDuel();
                    }, 2000);
                    
                }, 3000);
                
            }, 500);
        }

        function createDuelCard(card, actualPower = null) {
            const cardElement = document.createElement('div');
            cardElement.className = `duel-card ${card.type}`;
            cardElement.style.cursor = 'pointer';
            
            const abilityText = card.ability ? `<div class="card-ability">${card.ability}</div>` : '';
            const displayPower = actualPower !== null ? actualPower : card.power;
            
            cardElement.innerHTML = `
                <div class="card-emoji" style="font-size: 2.5rem; margin-bottom: 6px;">${card.emoji}</div>
                <div class="card-name">${card.name}</div>
                ${abilityText}
                <div class="card-power">${card.power}</div>
                <div class="power-display">${displayPower} Power</div>
            `;
            
            // Add click event for zoom
            cardElement.addEventListener('click', (e) => {
                e.stopPropagation();
                openCardZoom(card);
            });
            
            return cardElement;
        }

        function skipDuel() {
            addLog(`You chose to skip the duel.`);
            document.getElementById('duelButtons').style.display = 'none';
            continueTurn();
        }

        function continueTurn() {
            document.getElementById('duelButtons').style.display = 'none';
            document.getElementById('drawButton').disabled = false;
            
            // Continue with normal turn progression
            if (currentPlayer === 'human') {
                currentPlayer = 'ai';
                setTimeout(aiTurn, 1000);
            } else {
                currentPlayer = 'human';
            }
            
            updateTurnDisplay();
        }

        function showChallengeOptions() {
            document.getElementById('challengeModal').style.display = 'flex';
        }

        // New Duel Proposal System
        function proposeDuel(opponent) {
            const opponentName = opponent === 'ai' ? 'Player 2' : 'FATE';
            addLog(`⚔️ You propose a duel to ${opponentName}...`);
            
            // Opponent decides whether to accept (70% chance to accept)
            const acceptChance = Math.random();
            const willAccept = acceptChance > 0.3;
            
            if (willAccept) {
                addLog(`${opponentName} accepts your duel challenge!`);
                setTimeout(() => initiateDuel(opponent), 1000);
            } else {
                // Opponent refuses and loses a random card to you
                const opponentCards = players[opponent].cards;
                if (opponentCards.length > 0) {
                    const randomIndex = Math.floor(Math.random() * opponentCards.length);
                    const lostCard = opponentCards.splice(randomIndex, 1)[0];
                    
                    players[opponent].power -= lostCard.power;
                    players.human.cards.push(lostCard);
                    players.human.power += lostCard.power;
                    
                    addLog(`${opponentName} refuses and forfeits ${lostCard.name} to you!`, 'steal');
                    
                    // Update display
                    updateCardDisplay();
                    updateDisplay();
                } else {
                    addLog(`${opponentName} refuses but has no cards to forfeit.`);
                }
            }
            
            document.getElementById('challengeModal').style.display = 'none';
        }

        function closeDuelModal() {
            document.getElementById('duelModal').style.display = 'none';
        }

        function closeChallengeModal() {
            document.getElementById('challengeModal').style.display = 'none';
        }

        function updateCardDisplay() {
            // Clear and rebuild card displays
            const humanArea = document.getElementById('humanCardArea');
            const aiArea = document.getElementById('aiCardArea');
            const fateArea = document.getElementById('fateCardArea');
            
            humanArea.innerHTML = '';
            aiArea.innerHTML = '';
            fateArea.innerHTML = '';
            
            // Rebuild human cards
            players.human.cards.forEach(card => {
                const cardElement = createCardElement(card);
                humanArea.appendChild(cardElement);
            });
            
            // Rebuild AI cards (hidden)
            players.ai.cards.forEach(card => {
                const cardElement = createHiddenCard();
                aiArea.appendChild(cardElement);
            });
            
            // Rebuild FATE cards
            players.fate.cards.forEach(card => {
                const cardElement = createCardElement(card);
                fateArea.appendChild(cardElement);
            });
        }

        function addLog(message, type = '') {
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry ${type}`;
            logEntry.textContent = message;
            
            const gameLog = document.getElementById('gameLog');
            gameLog.appendChild(logEntry);
            gameLog.scrollTop = gameLog.scrollHeight;
        }

        function endGame() {
            gameEnded = true;
            
            // Calculate total card values for each player
            const humanTotal = calculatePlayerTotal('human');
            const aiTotal = calculatePlayerTotal('ai');
            const fateTotal = calculatePlayerTotal('fate');
            
            // Determine winner based on total card values
            let winner = 'human';
            let maxTotal = humanTotal;
            
            if (aiTotal > maxTotal) {
                winner = 'ai';
                maxTotal = aiTotal;
            }
            
            if (fateTotal > maxTotal) {
                winner = 'fate';
                maxTotal = fateTotal;
            }

            // Show appropriate end screen
            const gameOver = document.getElementById('gameOver');
            const winnerText = document.getElementById('winnerText');
            const finalScores = document.getElementById('finalScores');
            
            if (winner === 'human') {
                // Player wins
                winnerText.textContent = '🏆 VICTORY!';
                winnerText.style.color = '#10b981';
                finalScores.innerHTML = `
                    <div style="color: #10b981; font-weight: bold; font-size: 1.3rem;">🎉 Congratulations! You are the champion! 🎉</div>
                    <div style="margin-top: 20px;">
                        <div style="color: #10b981; font-weight: bold;">You: ${humanTotal} total power (${players.human.cards.length} cards)</div>
                        <div>Player 2: ${aiTotal} total power (${players.ai.cards.length} cards)</div>
                        <div>FATE: ${fateTotal} total power (${players.fate.cards.length} cards)</div>
                    </div>
                    <div style="margin-top: 15px; color: #fbbf24;">Your strategic card play led you to victory!</div>
                `;
                addLog(`🏆 VICTORY! You win with ${humanTotal} total power!`);
            } else {
                // Player loses - Game Over
                winnerText.textContent = '💀 GAME OVER';
                winnerText.style.color = '#dc2626';
                
                const winnerName = winner === 'ai' ? 'Player 2' : 'FATE';
                const winnerEmoji = winner === 'ai' ? '🤖' : '💀';
                
                finalScores.innerHTML = `
                    <div style="color: #dc2626; font-weight: bold; font-size: 1.3rem;">You have been defeated!</div>
                    <div style="color: #fbbf24; margin: 15px 0;">${winnerEmoji} ${winnerName} emerges victorious!</div>
                    <div style="margin-top: 20px;">
                        <div style="color: #dc2626;">You: ${humanTotal} total power (${players.human.cards.length} cards)</div>
                        <div style="color: #10b981; font-weight: bold;">${winnerName}: ${maxTotal} total power (${players[winner].cards.length} cards)</div>
                        <div>${winner === 'ai' ? 'FATE' : 'Player 2'}: ${winner === 'ai' ? fateTotal : aiTotal} total power (${players[winner === 'ai' ? 'fate' : 'ai'].cards.length} cards)</div>
                    </div>
                    <div style="margin-top: 15px; color: #6b7280; font-style: italic;">Better luck next time! Try a different strategy.</div>
                `;
                addLog(`💀 GAME OVER! ${winnerName} wins with ${maxTotal} total power!`, 'steal');
            }
            
            setTimeout(() => {
                gameOver.style.display = 'flex';
            }, 1000);
        }

        function calculatePlayerTotal(player) {
            return players[player].cards.reduce((total, card) => total + card.power, 0);
        }

        // Duel context tracking
        let currentDuelContext = {
            opponent: null,
            playerCards: [],
            opponentCards: []
        };

        function getCurrentDuelOpponent() {
            return currentDuelContext.opponent;
        }

        function getCurrentPlayerDuelCards() {
            return currentDuelContext.playerCards;
        }

        function getCurrentOpponentDuelCards() {
            return currentDuelContext.opponentCards;
        }

        function transferCardsToPlayer(cards, opponent) {
            cards.forEach(card => {
                const cardIndex = players[opponent].cards.indexOf(card);
                if (cardIndex !== -1) {
                    players[opponent].cards.splice(cardIndex, 1);
                    players[opponent].power -= card.power;
                    players.human.cards.push(card);
                    players.human.power += card.power;
                }
            });
        }

        function transferCardsFromPlayer(cards, opponent) {
            cards.forEach(card => {
                const cardIndex = players.human.cards.indexOf(card);
                if (cardIndex !== -1) {
                    players.human.cards.splice(cardIndex, 1);
                    players.human.power -= card.power;
                    players[opponent].cards.push(card);
                    players[opponent].power += card.power;
                }
            });
        }

        function finishDuel() {
            if (currentDuelContext.opponent === 'fate') {
                document.getElementById('fateArea').classList.remove('active');
                setTimeout(() => {
                    document.getElementById('fateArea').style.display = 'none';
                    currentPlayer = 'human';
                    updateTurnDisplay();
                }, 500);
            } else {
                continueTurn();
            }
            
            // Reset duel context
            currentDuelContext = {
                opponent: null,
                playerCards: [],
                opponentCards: []
            };
        }

        // AI and FATE duel proposal functions
        function aiProposeDuel() {
            addLog(`🤖 Player 2 proposes a duel to you!`);
            
            // Player decides whether to accept (you can choose)
            const acceptChance = Math.random();
            const willAccept = acceptChance > 0.4; // 60% chance player accepts
            
            if (willAccept) {
                addLog(`You accept Player 2's duel challenge!`);
                setTimeout(() => {
                    // AI initiates duel against you
                    aiInitiateDuel();
                }, 1000);
            } else {
                // Player refuses and loses a random card
                if (players.human.cards.length > 0) {
                    const randomIndex = Math.floor(Math.random() * players.human.cards.length);
                    const lostCard = players.human.cards.splice(randomIndex, 1)[0];
                    
                    players.human.power -= lostCard.power;
                    players.ai.cards.push(lostCard);
                    players.ai.power += lostCard.power;
                    
                    addLog(`You refuse and forfeit ${lostCard.name} to Player 2!`, 'steal');
                    updateCardDisplay();
                } else {
                    addLog(`You refuse but have no cards to forfeit.`);
                }
                updateDisplay();
                nextTurn();
            }
        }

        function fateProposeDuel() {
            addLog(`💀 FATE challenges you to a duel!`);
            
            // Player decides whether to accept
            const acceptChance = Math.random();
            const willAccept = acceptChance > 0.3; // 70% chance player accepts
            
            if (willAccept) {
                addLog(`You accept FATE's deadly challenge!`);
                setTimeout(() => {
                    // FATE initiates duel against you
                    fateInitiateDuel();
                }, 1000);
            } else {
                // Player refuses and loses a random card
                if (players.human.cards.length > 0) {
                    const randomIndex = Math.floor(Math.random() * players.human.cards.length);
                    const lostCard = players.human.cards.splice(randomIndex, 1)[0];
                    
                    players.human.power -= lostCard.power;
                    players.fate.cards.push(lostCard);
                    players.fate.power += lostCard.power;
                    
                    addLog(`You refuse and forfeit ${lostCard.name} to FATE!`, 'steal');
                    updateCardDisplay();
                    
                    // Add to FATE's display
                    const fateCard = createCardElement(lostCard);
                    const fateCardArea = document.getElementById('fateCardArea');
                    fateCardArea.appendChild(fateCard);
                    
                    // Scroll to show the new card
                    setTimeout(() => {
                        fateCardArea.scrollLeft = fateCardArea.scrollWidth;
                    }, 200);
                } else {
                    addLog(`You refuse but have no cards to forfeit.`);
                }
                
                updateDisplay();
                
                setTimeout(() => {
                    document.getElementById('fateArea').classList.remove('active');
                    setTimeout(() => {
                        document.getElementById('fateArea').style.display = 'none';
                        currentPlayer = 'human';
                        updateTurnDisplay();
                    }, 500);
                }, 2000);
            }
        }

        function aiInitiateDuel() {
            // AI automatically selects up to 3 cards for duel
            const aiCards = players.ai.cards;
            const maxCards = Math.min(3, aiCards.length);
            const selectedAiCards = [];
            
            // AI picks its strongest cards
            const sortedAiCards = [...aiCards].sort((a, b) => b.power - a.power);
            for (let i = 0; i < maxCards; i++) {
                selectedAiCards.push(sortedAiCards[i]);
            }
            
            // Player automatically selects up to 3 cards (strongest available)
            const humanCards = players.human.cards;
            const maxHumanCards = Math.min(3, humanCards.length);
            const selectedHumanCards = [];
            
            const sortedHumanCards = [...humanCards].sort((a, b) => b.power - a.power);
            for (let i = 0; i < maxHumanCards; i++) {
                selectedHumanCards.push(sortedHumanCards[i]);
            }
            
            executeAutoDuel(selectedHumanCards, selectedAiCards, 'ai');
        }

        function fateInitiateDuel() {
            // FATE automatically selects up to 3 cards for duel
            const fateCards = players.fate.cards;
            const maxCards = Math.min(3, fateCards.length);
            const selectedFateCards = [];
            
            // FATE picks random cards (more unpredictable)
            const shuffledFateCards = [...fateCards].sort(() => Math.random() - 0.5);
            for (let i = 0; i < maxCards; i++) {
                selectedFateCards.push(shuffledFateCards[i]);
            }
            
            // Player automatically selects up to 3 cards (strongest available)
            const humanCards = players.human.cards;
            const maxHumanCards = Math.min(3, humanCards.length);
            const selectedHumanCards = [];
            
            const sortedHumanCards = [...humanCards].sort((a, b) => b.power - a.power);
            for (let i = 0; i < maxHumanCards; i++) {
                selectedHumanCards.push(sortedHumanCards[i]);
            }
            
            executeAutoDuel(selectedHumanCards, selectedFateCards, 'fate');
        }

        function executeAutoDuel(playerCards, opponentCards, opponent) {
            // Show duel animation for auto-duels too
            showAutoDuelAnimation(playerCards, opponentCards, opponent);
        }

        function showAutoDuelAnimation(playerCards, opponentCards, opponent) {
            // Set duel context
            currentDuelContext = {
                opponent: opponent,
                playerCards: playerCards,
                opponentCards: opponentCards
            };
            
            const arena = document.getElementById('duelArena');
            const leftCards = document.getElementById('leftDuelCards');
            const rightCards = document.getElementById('rightDuelCards');
            const leftPower = document.getElementById('leftDuelPower');
            const rightPower = document.getElementById('rightDuelPower');
            const rightPlayerName = document.getElementById('rightPlayerName');
            const resultText = document.getElementById('duelResultText');
            
            // Set opponent name
            const opponentName = opponent === 'ai' ? 'Player 2' : 'FATE';
            rightPlayerName.textContent = opponentName;
            
            // Clear previous cards and result
            leftCards.innerHTML = '';
            rightCards.innerHTML = '';
            resultText.textContent = '';
            resultText.style.opacity = '0';
            
            // Calculate powers
            let playerTotalPower = 0;
            let opponentTotalPower = 0;
            
            // Create player cards
            playerCards.forEach(card => {
                let cardPower = card.power;
                if (card.type === 'major') {
                    cardPower = applyDuelBonus(card, cardPower);
                }
                playerTotalPower += cardPower;
                
                const cardElement = createDuelCard(card, cardPower);
                leftCards.appendChild(cardElement);
            });
            
            // Create opponent cards
            opponentCards.forEach(card => {
                let cardPower = card.power;
                if (card.type === 'major') {
                    cardPower = applyDuelBonus(card, cardPower);
                }
                opponentTotalPower += cardPower;
                
                const cardElement = createDuelCard(card, cardPower);
                rightCards.appendChild(cardElement);
            });
            
            // Set initial powers
            leftPower.textContent = playerTotalPower;
            rightPower.textContent = opponentTotalPower;
            
            // Show arena
            arena.style.display = 'flex';
            
            // Show continue button initially
            document.getElementById('duelControls').style.display = 'flex';
            document.getElementById('continueDuelBtn').style.display = 'block';
        }



        function restartGame() {
            // Reset everything
            currentTurn = 1;
            currentPlayer = 'human';
            gameEnded = false;
            selectedDuelCards = [];
            duelOpponent = null;
            
            players = {
                human: { cards: [], power: 0 },
                ai: { cards: [], power: 0 },
                fate: { cards: [], power: 0 }
            };
            
            deck = [...cardDatabase];
            shuffleDeck();
            
            // Clear displays
            document.getElementById('humanCardArea').innerHTML = '';
            document.getElementById('aiCardArea').innerHTML = '';
            document.getElementById('fateCardArea').innerHTML = '';
            document.getElementById('gameLog').innerHTML = '<div class="log-entry">Game restarted! Draw your first card.</div>';
            
            // Hide all modals and special buttons
            document.getElementById('gameOver').style.display = 'none';
            document.getElementById('duelModal').style.display = 'none';
            document.getElementById('challengeModal').style.display = 'none';
            document.getElementById('duelArena').style.display = 'none';
            document.getElementById('fateArea').style.display = 'none';
            document.getElementById('duelButtons').style.display = 'none';
            document.getElementById('challengeButton').style.display = 'none';
            
            updateDisplay();
            updateTurnDisplay();
        }

        // Card Zoom System
        let isCardFlipped = false;
        let isDragging = false;
        let startX = 0;

        function openCardZoom(card) {
            const overlay = document.getElementById('cardZoomOverlay');
            const cardZoom = document.getElementById('cardZoom');
            const cardFront = document.getElementById('cardFront');
            const slideHint = document.getElementById('slideHint');
            
            // Reset flip state
            isCardFlipped = false;
            cardZoom.classList.remove('flipped');
            
            // Set card data
            document.getElementById('zoomCardName').innerHTML = `<div style="font-size: 3rem; margin-bottom: 10px;">${card.emoji}</div>${card.name}`;
            document.getElementById('zoomCardNameBack').innerHTML = `<div style="font-size: 3rem; margin-bottom: 10px;">${card.emoji}</div>${card.name}`;
            document.getElementById('zoomCardPower').querySelector('span').textContent = card.power;
            document.getElementById('bubblePower').textContent = card.power;
            
            // Set ability or no ability message
            const abilityElement = document.getElementById('zoomCardAbility');
            if (card.ability) {
                abilityElement.textContent = card.ability;
                abilityElement.className = 'card-ability';
                slideHint.style.display = 'block';
            } else {
                abilityElement.textContent = 'This card has no special ability';
                abilityElement.className = 'card-ability no-ability';
                slideHint.style.display = 'none';
            }
            
            // Apply card type styling
            if (card.type === 'major') {
                cardFront.classList.add('major');
            } else {
                cardFront.classList.remove('major');
            }
            
            // Show overlay
            overlay.style.display = 'flex';
            
            // Show power bubble after a delay
            setTimeout(() => {
                document.getElementById('powerBubble').classList.add('show');
            }, 500);
            
            // Add touch/mouse events for sliding
            setupCardDragEvents();
        }

        function setupCardDragEvents() {
            const cardZoom = document.getElementById('cardZoom');
            
            // Mouse events
            cardZoom.addEventListener('mousedown', startDrag);
            cardZoom.addEventListener('mousemove', drag);
            cardZoom.addEventListener('mouseup', endDrag);
            cardZoom.addEventListener('mouseleave', endDrag);
            
            // Touch events
            cardZoom.addEventListener('touchstart', startDrag);
            cardZoom.addEventListener('touchmove', drag);
            cardZoom.addEventListener('touchend', endDrag);
        }

        function startDrag(e) {
            isDragging = true;
            startX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
            e.preventDefault();
        }

        function drag(e) {
            if (!isDragging) return;
            
            const currentX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
            const deltaX = currentX - startX;
            
            // Flip threshold
            if (Math.abs(deltaX) > 50) {
                if (deltaX > 0 && !isCardFlipped) {
                    flipCard();
                } else if (deltaX < 0 && isCardFlipped) {
                    flipCard();
                }
                isDragging = false;
            }
            
            e.preventDefault();
        }

        function endDrag(e) {
            isDragging = false;
            e.preventDefault();
        }

        function flipCard() {
            const cardZoom = document.getElementById('cardZoom');
            const slideHint = document.getElementById('slideHint');
            
            isCardFlipped = !isCardFlipped;
            
            if (isCardFlipped) {
                cardZoom.classList.add('flipped');
                slideHint.style.display = 'none';
            } else {
                cardZoom.classList.remove('flipped');
                // Only show hint if card has ability
                const abilityElement = document.getElementById('zoomCardAbility');
                if (!abilityElement.classList.contains('no-ability')) {
                    slideHint.style.display = 'block';
                }
            }
        }

        function closeCardZoom() {
            const overlay = document.getElementById('cardZoomOverlay');
            const powerBubble = document.getElementById('powerBubble');
            const cardZoom = document.getElementById('cardZoom');
            
            // Hide power bubble
            powerBubble.classList.remove('show');
            
            // Reset flip state
            isCardFlipped = false;
            cardZoom.classList.remove('flipped');
            
            // Hide overlay
            overlay.style.display = 'none';
            
            // Clean up event listeners
            cardZoom.removeEventListener('mousedown', startDrag);
            cardZoom.removeEventListener('mousemove', drag);
            cardZoom.removeEventListener('mouseup', endDrag);
            cardZoom.removeEventListener('mouseleave', endDrag);
            cardZoom.removeEventListener('touchstart', startDrag);
            cardZoom.removeEventListener('touchmove', drag);
            cardZoom.removeEventListener('touchend', endDrag);
        }

        // Close zoom when clicking outside
        document.getElementById('cardZoomOverlay').addEventListener('click', (e) => {
            if (e.target.id === 'cardZoomOverlay') {
                closeCardZoom();
            }
        });

        // Initialize game
        updateDisplay();
        updateTurnDisplay();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96c1f1aaa20c7a01',t:'MTc1NDY4NjgzNS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>